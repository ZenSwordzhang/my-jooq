input {
    http {
        port => 8088
        codec => "json"
        add_field => {
            source => "http"
        }
    }
    beats {
        port => 5044
        add_field => {
            source => "beats"
        }
        ssl => true
        # This key need to be in the PKCS8 format
        ssl_key => "${CERTS_DIR_LOGSTASH}/logstash01/logstash01.pem"
        ssl_certificate => "${CERTS_DIR_LOGSTASH}/logstash01/logstash01.crt"
        ssl_certificate_authorities => "${CERTS_DIR_LOGSTASH}/ca/ca.crt"
        ssl_verify_mode => "peer"
        # SSL key passphrase to use
        # ssl_key_passphrase => ""
    }
    file {
        add_field => {
            source => "file"
            from => "spring"
        }
        path => ["/usr/share/logstash/logs/test.log"]
        sincedb_path => "NUL"
        start_position => "beginning"
    }
}

output {
    elasticsearch {
        hosts => ["https://es01:9200"]
        index => "%{[source]}-%{[from]}-%{+YYYYMMdd}"
        ssl_certificate_verification => true
        ssl => true
        cacert => "${CERTS_DIR_LOGSTASH}/ca/ca.crt"
        user => "elastic"
        password => "123456"
        manage_template => false
    }
    # stdout { codec => rubydebug }
}
